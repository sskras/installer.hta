<!DOCTYPE HTML>
<!-- Via: https://stackoverflow.com/questions/19567887/javascript-version-in-hta/19570684#19570684 -->

<!--
  SPDX-License-Identifier: BlueOak-1.0.0
  SPDX-FileCopyrightText: 2024 Saulius Krasuckas <saulius2_at_ar-fi_point_lt> | sskras

  Via: https://gitlab.com/chrismbradford/osd-wizard
 -->

<html>
  <head>
    <meta http-equiv="x-ua-compatible" content="IE=8" />
    <!-- Via: https://stackoverflow.com/questions/52800783/how-to-select-the-version-of-internet-explorer-for-hta-html-application/52801066#52801066 -->
    <!-- Via: https://stackoverflow.com/questions/24297029/hta-and-x-ua-compatible-meta-tag#:~:text=best%20overall%20results%20with%20IE%3D9%20or%20IE%3D10 -->
    <!-- Via: https://stackoverflow.com/questions/10975107/forcing-internet-explorer-9-to-use-standards-document-mode -->
    <!-- Via: https://hsivonen.fi/doctype/#ie8 -->
    <!-- Via: https://web.archive.org/web/20160114091626/https://blogs.msdn.microsoft.com/ie/2010/10/19/testing-sites-with-browser-mode-vs-doc-mode/ -->
    <!--
      * IE=5,7,8,9:
        - breaks the Input Clear button removal;
          (the button is unusual to see in a focused edit box )
      * IE=8:
        - paints the inner border regardless of the <HTA INNERBORDER=...> parameter when the preceding element is not the <style>;
          (could be worked around by placing the empty <script> </script> element there)
      * IE=9:
        - breaks blocking the intercepted hotkeys;
          (so the content becomes zoomable using Ctrl-[-] and Ctrl-[+] again)
      * IE=10,11:
        - breaks the <HTA> tag parsing;
          (most of window properties/fine-tunings are lost)
     -->

    <title>TODO Installer title</title>

    <style>
      /* Via: https://developer.mozilla.org/en-US/docs/Web/CSS/Comments#syntax */

      window {
        width:  640px;
        height: 480px;
      }

      body {
        /* Picked gray background color from the main window of "gBurner Virtual Drive 5.2 Setup": */
        background-color: #F0F0F0;
        /* Via: https://stackoverflow.com/questions/13712697/set-background-color-in-hex/75054561#75054561 */

        font-family:  'MS Shell Dlg 2';
        font-size:    11pt;
        font-weight:  400;
        font-style:   normal;
        /* Via: https://learn.microsoft.com/en-us/windows/win32/intl/using-ms-shell-dlg-and-ms-shell-dlg-2 */
        /* Via: https://forum.freecad.org/viewtopic.php?style=3&t=42414#p364805 */
      }

      input::-ms-clear
      {
        display: none;
        /* Via: https://blog.maximerouiller.com/post/remove-the-x-from-internet-explorer-and-chrome-input-type-search/ */
        /* Via: https://learn.microsoft.com/en-us/previous-versions/troubleshoot/browsers/development-website/how-to-hide-clear-button-ie-10 */

        width : 0;
        height: 0;
        /* Via: https://stackoverflow.com/questions/10842665/internet-explorer-10-windows-8-remove-text-input-and-password-action-icons/17986002#17986002 */
        /* Via: https://stackoverflow.com/questions/14007655/remove-ie10s-clear-field-x-button-on-certain-inputs/14739092#14739092 */
      }
      /* Both of the above tricks fail on IE11 which emulates IE<=9 -- the input's clear button stays present.

         Via: https://forum.profoundlogic.com/forum/viewtopic.php?t=1878#p6597
         Via: https://stackoverflow.com/questions/31448563/deactivate-the-clear-button-in-input-fields-for-ie8
         Via: https://stackoverflow.com/questions/19244916/remove-clear-field-x-button-when-browser-mode-ie9-document-modeie9-on-certa
         Via: https://docs2.w3cub.com/css/::-ms-clear/#:~:text=supported%20only%20in%20Internet%20Explorer%2010%20and%2011%20and%20Edge%2012%2B
         Via: https://yehg.net/lab/pr0js/misc/ie10-nopeeping/CSS/IE-10/
         Via: https://jwcooney.com/2013/11/04/fixing-ie-10-text-box-x-and-sizing-issues/
      */
    </style>

    <script>
      str_w  = document.styleSheets[0].rules[0].style['width'];
      str_h  = document.styleSheets[0].rules[0].style['height']
      // Via: https://stackoverflow.com/questions/16778814/read-css-property-from-stylesheet/16778879#16778879
      // Via: https://stackoverflow.com/questions/9180184/access-css-file-contents-via-javascript/9180271#9180271
      // Via: https://stackoverflow.com/questions/38059852/what-is-the-difference-between-the-cssrules-and-rules-objects#comment63559081_38059852
      // Via: https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleDeclaration
      // Via: https://stackoverflow.com/questions/56586320/is-there-a-difference-between-getpropertyvalue-and-the-bracket-notation-for

      width  = Number(str_w.replace(/px$/, ''));
      height = Number(str_h.replace(/px$/, ''));
      // Via: https://stackoverflow.com/questions/3024084/jquery-javascript-how-do-i-convert-a-pixel-value-20px-to-a-number-value-2
    </script>

    <style> "Workaround for IE8" </style>

    <HTA:APPLICATION
      APPLICATIONNAME = "installer.hta"         # Application name, used to identify a single application via SINGLEINSTANCE
      ICON            = "installer.ico"         # Application symbol
      BORDER          = "dialog"                # Make window non-resizable
      CONTEXTMENU     = "no"                    # Turn off the context (pop up) menu
      INNERBORDER     = "no"                    # Turn off the thin inner lines
      MAXIMIZEBUTTON  = "no"                    # Disable maximizing the window
      MINIMIZEBUTTON  = "yes"                   # Enable minimizing the window
      SCROLL          = "no"                    # Turn off the scrollbars
      SELECTION       = "no"                    # Make UI text non-selectable
      SINGLEINSTANCE  = "yes"                   # Allow only one instance of the app to run
      SYSMENU         = "yes"                   # Show system menu + buttons [_][ ][X]
      WINDOWSTATE     = "normal"                # Leave window in the default state ("minimize" could help the seamless initial sizing)
    />
    <!-- Via: https://learn.microsoft.com/en-us/previous-versions/ms536495(v=vs.85) -->

  </head>

  <script language="JScript">

    document.title = document.documentMode + ": " + navigator.userAgent;
    // Via: https://stackoverflow.com/questions/10964966/detect-ie-version-prior-to-v9-in-javascript/20411654#20411654
    // Via: https://stackoverflow.com/questions/10964966/detect-ie-version-prior-to-v9-in-javascript/24287280#24287280

    alert(document.title);

      window.resizeTo(width, height);

      var x_offset = (screen.width - width)/2;
      var y_offset = (screen.height - height)/2;

      window.moveTo(x_offset, y_offset);

      // Debug via printing:
      //
 //   debug_msg = "screen.width - document.body.clientWidth = " + (screen.width - document.body.clientWidth)
 //      + "\n" + "document.body.clientWidth = " + document.body.clientWidth
 //      + "\n" + "width = " + width;
      //
      // Su garsiniu įspėjimu:
      //
 //   alert(debug_msg);
      //
      // Tyliai:
      //
 //   var shell = new ActiveXObject("WScript.Shell");
 //   shell.Popup(debug_msg);
      //
      // Via: https://stackoverflow.com/questions/3106806/how-to-show-a-popup-without-a-browser/3112653#3112653

    function disable_hotkeys()
    {
      // Let's disable following hotkeys:
      //   - Ctrl-P         (avoid Printing dialog)
      //   - Ctrl-F5, F5    (avoid page reloads)
      //   - Ctrl-[-]       (avoid zooming out)
      //   - Ctrl-[+]       (avoid zooming in)

      VK_P         =  80;
      VK_F5        = 116;
      VK_OEM_PLUS  = 187;
      VK_OEM_MINUS = 189;
      // Via: https://cherrytree.at/misc/vk.htm
      // Via: https://stackoverflow.com/questions/6888570/declaring-variables-without-var-keyword

      var ev = window.event;

      if ((ev.keyCode == VK_P) || (ev.keyCode == VK_OEM_PLUS) || (ev.keyCode == VK_OEM_MINUS))
      {
        if (ev.ctrlKey == false) return;
        if (ev.altKey == true) return;
        if (ev.shiftKey == true) return;
      }
      else if ((ev.keyCode == VK_F5))
      {
        if (ev.altKey == true) return;
        if (ev.shiftKey == true) return;
      }
      else return;

      alert("The key is disabled: \n\n" + "ev.keyCode: " + ev.keyCode + "\n" + "ev.ctrlKey: " + ev.ctrlKey + "\n" + "ev.altKey: " + ev.altKey + "\n" + "ev.shiftKey: " + ev.shiftKey);

      // Got a blacklisted key combo. Block it:
      ev.keyCode = 0;
      ev.returnValue = null;
    }

    document.onkeydown = disable_hotkeys;
    // Via: https://stackoverflow.com/questions/1130353/disable-internet-explorer-shortcut-keys/5354547#5354547

  </script>

  <body>
    Welcome to the app setup:
    <hr/>

    <table width="100%" cellspacing="0" border="0">

      <tr>
        <td>
          Line 1:
        </td>

        <td align="right">
          EOL
        </td>
      </tr>

      <tr>
        <td>
          Line 2:
        </td>

        <td>
          Let us input some text:
          <input size="30" name="Text1">
        </td>
      </tr>

      <tr>
        <td>
          Line 3:
        </td>

        <td>
          Let us make a selection:
          <input type="radio" name="Options1" value="Yes">Yes</input>
          <input type="radio" name="Options1" value="No" checked>No</input>
        </td>
      </tr>

      <tr>
        <td>
          Line 4:
        </td>

        <td>
          <label for="Combo1">Let us see more choices:</label>
          <select size="1" name="Combo1" onChange="vbs:vbs_script_name">
            <option>A thing</option>
            <option>Another thing</option>
            <option>Yet another thing</option>
          </select>
        </td>
      </tr>

    </table>
    <!-- Via: https://gitlab.com/chrismbradford/osd-wizard/-/commit/e709f9b3e7a97b21c6ffa8f4bbee5a5d1151e160 -->

  </body>
</html>
